<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a custom validation check function template file. — create_custom_check • hubValidations</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a custom validation check function template file. — create_custom_check"><meta name="description" content="Create a custom validation check function template file."><meta property="og:description" content="Create a custom validation check function template file."><meta property="og:image" content="https://hubverse-org.github.io/hubValidations/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://hubdocs.readthedocs.io/en/latest/" class="external-link"><img src="https://raw.githubusercontent.com/hubverse-org/hubStyle/main/inst/hubverse.png" id="logo" height="30" alt="hubverse"></a>
    <a class="navbar-brand me-2" href="../index.html">hubValidations</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/hub-validations-class.html">Structure of hub_validations class objects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Validation for hub admins through CI</h6></li>
    <li><a class="dropdown-item" href="../articles/validate-pr.html">Validating Pull Requests on GitHub</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Validation for submitting teams</h6></li>
    <li><a class="dropdown-item" href="../articles/validate-submission.html">Validating submissions locally</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Custom validation checks</h6></li>
    <li><a class="dropdown-item" href="../articles/writing-custom-fns.html">Writing custom validation functions</a></li>
    <li><a class="dropdown-item" href="../articles/deploying-custom-functions.html">Deploying custom validation functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hubverse-org/hubValidations/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a custom validation check function template file.</h1>
      <small class="dont-index">Source: <a href="https://github.com/hubverse-org/hubValidations/blob/main/R/create_custom_check.R" class="external-link"><code>R/create_custom_check.R</code></a></small>
      <div class="d-none name"><code>create_custom_check.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a custom validation check function template file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_custom_check</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  hub_path <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  r_dir <span class="op">=</span> <span class="st">"src/validations/R"</span>,</span>
<span>  error <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  conditional <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  error_object <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  config <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  extra_args <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>Character string. Name of the custom check function. We recommend
following the hubValidations package naming convention. For more details, consult the
article on <a href="https://hubverse-org.github.io/hubValidations/articles/writing-custom-fns.html">writing custom check functions</a>.</p></dd>


<dt id="arg-hub-path">hub_path<a class="anchor" aria-label="anchor" href="#arg-hub-path"></a></dt>
<dd><p>Character string. Path to the hub directory. Default is the
current working directory.</p></dd>


<dt id="arg-r-dir">r_dir<a class="anchor" aria-label="anchor" href="#arg-r-dir"></a></dt>
<dd><p>Character string. Path (relative to <code>hub_path</code>) to the directory
the custom check function file will be written to. Default is <code>src/validations/R</code>
which is the recommended directory for storing custom check functions.</p></dd>


<dt id="arg-error">error<a class="anchor" aria-label="anchor" href="#arg-error"></a></dt>
<dd><p>Logical. Defaults to <code>FALSE</code>, which will return a
<code>&lt;error/check_failure&gt;</code> class object in the case of a failed check.
Set this to <code>TRUE</code> if your custom check function is required to pass for
other custom checks to be performed; in the case of a failed check, the custom check
function will then return an <code>&lt;error/check_error&gt;</code> class object and cause custom
validations to return early. Note that in the case of custom validations, executions
errors in custom functions will also result in custom validations returning early.</p></dd>


<dt id="arg-conditional">conditional<a class="anchor" aria-label="anchor" href="#arg-conditional"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the custom check function template will
include a block of code to check a condition before running the check. This is useful
when a check may need to be skipped based on a condition.</p></dd>


<dt id="arg-error-object">error_object<a class="anchor" aria-label="anchor" href="#arg-error-object"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the custom check function template will
include an error object that can be used to store additional information about the
properties of the object being checked that caused check failure. For example,
it could store the index of rows in a <code>tbl</code> that caused a check failure.</p></dd>


<dt id="arg-config">config<a class="anchor" aria-label="anchor" href="#arg-config"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the custom check function template will
include <code>hub_path</code> as a function argument and a block of code for reading in
the hub <code>tasks.json</code> config file.</p></dd>


<dt id="arg-extra-args">extra_args<a class="anchor" aria-label="anchor" href="#arg-extra-args"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the custom check function template will
include an <code>extra_arg</code> template function argument and template block of code
to check the input arguments of the custom check function.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the function will overwrite an existing</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisible <code>TRUE</code> if the custom check function file is created successfully.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See the article on <a href="https://hubverse-org.github.io/hubValidations/articles/writing-custom-fns.html">writing custom check functions</a>
for more.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_tempfile.html" class="external-link">with_tempdir</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Create the custom check file with default settings.</span></span></span>
<span class="r-in"><span>  <span class="fu">create_custom_check</span><span class="op">(</span><span class="st">"check_default"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"src/validations/R/check_default.R"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Create fully featured custom check file.</span></span></span>
<span class="r-in"><span>  <span class="fu">create_custom_check</span><span class="op">(</span><span class="st">"check_full"</span>,</span></span>
<span class="r-in"><span>    error <span class="op">=</span> <span class="cn">TRUE</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    error_object <span class="op">=</span> <span class="cn">TRUE</span>, config <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    extra_args <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"src/validations/R/check_full.R"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Directory <span style="color: #0000BB;">src/validations/R</span> created.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Custom validation check template function file <span style="color: #0000BB;">"check_default.R"</span> created.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → Edit the function template to add your custom check logic.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> See the <span style="color: #00BB00;">Writing custom check functions</span> article for more information.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (<span style="color: #0000BB; font-style: italic;">&lt;https://hubverse-org.github.io/hubValidations/articles/writing-custom-fns.html&gt;</span>)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> check_default &lt;- function(tbl, file_path) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Here you can write your custom check logic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Assign the result as `TRUE` or `FALSE` to object called `check`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # If `check` is `TRUE`, the check will pass.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   check &lt;- condition_to_be_TRUE_for_check_to_pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (check) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     details &lt;- NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     # You can use details messages to pass on helpful information to users about</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     # what caused the validation failure and how to locate affected data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     details &lt;- cli::format_inline("{.var round_id} value {.val invalid} is invalid.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   hubValidations::capture_check_cnd(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     check = check,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     file_path = file_path,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg_subject = "{.var round_id}",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg_attribute = "valid.",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     error = FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     details = details</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Custom validation check template function file <span style="color: #0000BB;">"check_full.R"</span> created.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> → Edit the function template to add your custom check logic.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> See the <span style="color: #00BB00;">Writing custom check functions</span> article for more information.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> (<span style="color: #0000BB; font-style: italic;">&lt;https://hubverse-org.github.io/hubValidations/articles/writing-custom-fns.html&gt;</span>)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> check_full &lt;- function(tbl, file_path, hub_path, extra_arg = NULL) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # If you're providing additional custom arguments, make sure to include input checks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # at the top of your function. `checkmate` package provides a simple interface</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # for many useful basic checks and is available through hubValidations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # The following example checks that `extra_arg` is a single character string.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   checkmate::assert_character(extra_arg, len = 1L, null.ok)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   config_tasks &lt;- hubUtils::read_config(hub_path)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (!condition) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       capture_check_info(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         file_path,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "Condition for running this check was not met. Skipped."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Here you can write your custom check logic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # Assign the result as `TRUE` or `FALSE` to object called `check`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   # If `check` is `TRUE`, the check will pass.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   check &lt;- condition_to_be_TRUE_for_check_to_pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (check) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     details &lt;- NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     error_object &lt;- NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     # You can use details messages and any type of R object to pass on helpful</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     # information to users about what caused the validation failure and how to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     # locate affected data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     error_object &lt;- list(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       invalid_rows = which(tbl$example_task_id == "invalid")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     details &lt;- cli::format_inline("See {.var error_object} attribute for details.")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   hubValidations::capture_check_cnd(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     check = check,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     file_path = file_path,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg_subject = "{.var round_id}",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     msg_attribute = "valid.",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     error = TRUE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     error_object = error_object,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     details = details</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anna Krystalli, Evan Ray, Hugo Gruson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1. PR Previews built by <a href="https://www.netlify.com" class="external-link">Netlify</a>. Provided without <strong>any warranty</strong>.</p>
</div>

    </footer></div>





  </body></html>

